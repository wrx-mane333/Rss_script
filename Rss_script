local Players = game:GetService("Players")+
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local VirtualUser = game:GetService("VirtualUser")
local VirtualInputManager = game:GetService("VirtualInputManager")

local Player = Players.LocalPlayer
local _G = _G or {} 

-- // –ù–ê–°–¢–†–û–ô–ö–ò //
_G.AutoFarm = false
_G.AutoQuest = false
_G.FruitESP = false
_G.AutoCollectFruit = false
_G.ReachAura = true
_G.AutoStats = false
_G.FastAttack = true -- –ë—ã—Å—Ç—Ä–∞—è –∞—Ç–∞–∫–∞
_G.BringMobs = true -- –°–æ–±–∏—Ä–∞—Ç—å –º–æ–±–æ–≤ –≤ –∫—É—á—É
_G.StatToUpgrade = "Melee"
_G.AttackDist = 3
_G.MobileAttackOnly = true
_G.HitboxSize = 25 -- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–∞–∑–º–µ—Ä (–Ω–µ –±–æ–ª—å—à–µ 30!)
_G.FarmHeight = 5 -- –ù–ò–ó–ö–ê–Ø –≤—ã—Å–æ—Ç–∞ - —á—Ç–æ–±—ã —É—Ä–æ–Ω –ø—Ä–æ—Ö–æ–¥–∏–ª!
_G.BringMobsRadius = 8 -- –†–∞–¥–∏—É—Å –∫—Ä—É–≥–∞ –¥–ª—è –º–æ–±–æ–≤ (–æ–Ω–∏ –±—É–¥—É—Ç –≤–æ–∫—Ä—É–≥ —Ç–µ–±—è)
_G.RotatePlayer = false -- –ù–ï –≤—Ä–∞—â–∞—Ç—å - —Å—Ç–æ–∏–º –Ω–∞ –º–µ—Å—Ç–µ
_G.ServerHop = false -- –ê–≤—Ç–æ–ø–æ–∏—Å–∫ —Ñ—Ä—É–∫—Ç–æ–≤ –Ω–∞ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö
_G.ServerHopDelay = 300 -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç (300 —Å–µ–∫)

-- –°–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ñ—Ä—É–∫—Ç–æ–≤
local FruitSpawnData = {
    LastSeenFruits = {},
    SpawnTimes = {},
    AverageSpawnTime = 3600,
    LastDespawnTime = 0,
    KnownSpawnPoints = {} -- –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –ø–æ–∑–∏—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö —Ñ—Ä—É–∫—Ç–æ–≤
}

-- –°–ø–∏—Å–æ–∫ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–ø–∞–≤–Ω-–ø–æ–∏–Ω—Ç–æ–≤ —Ñ—Ä—É–∫—Ç–æ–≤ (First Sea)
local FruitSpawnLocations = {
    Vector3.new(-2900, 15, 251), -- Jungle
    Vector3.new(-1750, 15, 1650), -- Pirate Village
    Vector3.new(945, 70, 4353), -- Desert
    Vector3.new(-5420, 15, -2823), -- Frozen Village
    Vector3.new(-4505, 735, -2622), -- Sky Island
    Vector3.new(4875, 740, 733), -- Upper Sky
    Vector3.new(5543, 410, -79), -- Fountain City
    Vector3.new(61163, 11, 1819), -- Marine Fortress
}

local LastStatUpgrade = 0
local AttackCooldown = 0

-- // GUI –ò–ù–¢–ï–†–§–ï–ô–° //
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "BloxFruitMobileGUI_v5"
ScreenGui.Parent = Player:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false
ScreenGui.DisplayOrder = 1000

-- –ö–Ω–æ–ø–∫–∞ –ú–ï–ù–Æ
local ToggleBtn = Instance.new("TextButton")
ToggleBtn.Name = "ToggleBtn"
ToggleBtn.Parent = ScreenGui
ToggleBtn.BackgroundColor3 = Color3.fromRGB(0, 120, 255)
ToggleBtn.Position = UDim2.new(0.05, 0, 0.15, 0)
ToggleBtn.Size = UDim2.new(0, 60, 0, 60)
ToggleBtn.Font = Enum.Font.SourceSansBold
ToggleBtn.Text = "MENU"
ToggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleBtn.TextSize = 16
ToggleBtn.ZIndex = 100
ToggleBtn.BorderSizePixel = 2
ToggleBtn.BorderColor3 = Color3.fromRGB(255, 255, 255)
ToggleBtn.Active = true

local UICornerBtn = Instance.new("UICorner")
UICornerBtn.CornerRadius = UDim.new(0.5, 0)
UICornerBtn.Parent = ToggleBtn

-- –û—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.Size = UDim2.new(0.55, 0, 0.7, 0)
MainFrame.Visible = false
MainFrame.ZIndex = 101
MainFrame.BorderSizePixel = 0

local UICornerFrame = Instance.new("UICorner")
UICornerFrame.CornerRadius = UDim.new(0.05, 0)
UICornerFrame.Parent = MainFrame

-- –ó–∞–≥–æ–ª–æ–≤–æ–∫
local Title = Instance.new("TextLabel")
Title.Parent = MainFrame
Title.Text = "BLOX FRUITS SCRIPT v5"
Title.Size = UDim2.new(1, 0, 0.1, 0)
Title.BackgroundColor3 = Color3.fromRGB(255, 85, 0)
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.SourceSansBold
Title.TextSize = 18
Title.ZIndex = 102

local UICornerTitle = Instance.new("UICorner")
UICornerTitle.CornerRadius = UDim.new(0.1, 0)
UICornerTitle.Parent = Title

-- SCROLLING FRAME (–¥–ª—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –∫–Ω–æ–ø–æ–∫)
local ScrollFrame = Instance.new("ScrollingFrame")
ScrollFrame.Name = "ScrollFrame"
ScrollFrame.Parent = MainFrame
ScrollFrame.Position = UDim2.new(0.05, 0, 0.12, 0)
ScrollFrame.Size = UDim2.new(0.9, 0, 0.65, 0)
ScrollFrame.BackgroundTransparency = 1
ScrollFrame.ScrollBarThickness = 6
ScrollFrame.ZIndex = 102
ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0) -- –ë—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
ScrollFrame.ScrollBarImageColor3 = Color3.fromRGB(255, 85, 0)

-- –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–Ω—é
ToggleBtn.Activated:Connect(function()
    MainFrame.Visible = not MainFrame.Visible
end)

local ButtonCount = 0

local function CreateSwitch(text, defaultVal, callback)
    local btn = Instance.new("TextButton")
    btn.Parent = ScrollFrame -- –¢–µ–ø–µ—Ä—å –∫–Ω–æ–ø–∫–∏ –≤ ScrollFrame!
    btn.BackgroundColor3 = defaultVal and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(200, 0, 0)
    btn.Size = UDim2.new(1, -10, 0, 40) -- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞
    btn.Position = UDim2.new(0, 5, 0, ButtonCount * 45) -- –û—Ç—Å—Ç—É–ø –º–µ–∂–¥—É –∫–Ω–æ–ø–∫–∞–º–∏
    btn.Text = text .. ": " .. (defaultVal and "ON" or "OFF")
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 15
    btn.ZIndex = 103
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0.2, 0)
    corner.Parent = btn
    
    btn.Activated:Connect(function()
        local isOn = not (btn.Text:find("ON") ~= nil)
        btn.Text = text .. ": " .. (isOn and "ON" or "OFF")
        btn.BackgroundColor3 = isOn and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(200, 0, 0)
        callback(isOn)
    end)
    
    ButtonCount = ButtonCount + 1
    
    -- –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–∑–º–µ—Ä Canvas –¥–ª—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
    ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, ButtonCount * 45 + 10)
end

-- –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏
CreateSwitch("Auto Farm", _G.AutoFarm, function(val) _G.AutoFarm = val end)
CreateSwitch("Auto Quest", _G.AutoQuest, function(val) _G.AutoQuest = val end)
CreateSwitch("Fruit ESP (Server Only)", _G.FruitESP, function(val) _G.FruitESP = val end)
CreateSwitch("Auto Collect Fruit", _G.AutoCollectFruit, function(val) _G.AutoCollectFruit = val end)
CreateSwitch("Auto Stats (Melee)", _G.AutoStats, function(val) _G.AutoStats = val end)
CreateSwitch("Hitbox Reach", _G.ReachAura, function(val) _G.ReachAura = val end)
CreateSwitch("Server Hop (Find Fruits)", _G.ServerHop, function(val) _G.ServerHop = val end)

-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å
local InfoLabel = Instance.new("TextLabel")
InfoLabel.Parent = MainFrame
InfoLabel.Size = UDim2.new(0.9, 0, 0.08, 0)
InfoLabel.Position = UDim2.new(0.05, 0, 0.8, 0)
InfoLabel.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
InfoLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
InfoLabel.Font = Enum.Font.SourceSans
InfoLabel.TextSize = 12
InfoLabel.Text = "‚ö° Fast Attack & Bring Mobs –≤–∫–ª—é—á–µ–Ω—ã"
InfoLabel.ZIndex = 103

local UICornerInfo = Instance.new("UICorner")
UICornerInfo.CornerRadius = UDim.new(0.2, 0)
UICornerInfo.Parent = InfoLabel

-- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
local CloseBtn = Instance.new("TextButton")
CloseBtn.Parent = MainFrame
CloseBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
CloseBtn.Size = UDim2.new(0.4, 0, 0.08, 0)
CloseBtn.Position = UDim2.new(0.3, 0, 0.9, 0)
CloseBtn.Text = "HIDE MENU"
CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseBtn.Font = Enum.Font.SourceSansBold
CloseBtn.ZIndex = 103

local UICornerClose = Instance.new("UICorner")
UICornerClose.CornerRadius = UDim.new(0.2, 0)
UICornerClose.Parent = CloseBtn

CloseBtn.Activated:Connect(function()
    MainFrame.Visible = false
end)

-- –¢–∞–π–º–µ—Ä —Ñ—Ä—É–∫—Ç–æ–≤
local FruitTimerLabel = Instance.new("TextLabel")
FruitTimerLabel.Parent = ScreenGui
FruitTimerLabel.Position = UDim2.new(0.05, 0, 0.08, 0)
FruitTimerLabel.Size = UDim2.new(0, 280, 0, 32)
FruitTimerLabel.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
FruitTimerLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
FruitTimerLabel.Font = Enum.Font.SourceSansBold
FruitTimerLabel.TextSize = 14
FruitTimerLabel.ZIndex = 110
FruitTimerLabel.Text = "–§—Ä—É–∫—Ç—ã: –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è..."

local UICornerTimer = Instance.new("UICorner")
UICornerTimer.CornerRadius = UDim.new(0.2, 0)
UICornerTimer.Parent = FruitTimerLabel

-- // –õ–û–ì–ò–ö–ê –°–ö–†–ò–ü–¢–ê //

-- Server Hop —Ñ—É–Ω–∫—Ü–∏—è (–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø - –±–µ–∑ HttpGet)
local TeleportService = game:GetService("TeleportService")

local LastServerHopCheck = 0

local function ServerHop()
    pcall(function()
        print("üîç –ò—â—É –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–µ—Ä...")
        
        -- –ü—Ä–æ—Å—Ç–æ–π –º–µ—Ç–æ–¥ - —Ç–µ–ª–µ–ø–æ—Ä—Ç –Ω–∞ —Å–ª—É—á–∞–π–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
        local PlaceId = game.PlaceId
        
        -- –ò—Å–ø–æ–ª—å–∑—É–µ–º TeleportService –Ω–∞–ø—Ä—è–º—É—é
        TeleportService:Teleport(PlaceId, Player)
    end)
end

local function CheckForFruitsAndHop()
    if not _G.ServerHop then return end
    
    local currentTime = os.time()
    if currentTime - LastServerHopCheck < _G.ServerHopDelay then
        return
    end
    
    LastServerHopCheck = currentTime
    
    pcall(function()
        local fruits = FindAllFruits()
        
        if #fruits == 0 then
            print("üçé –§—Ä—É–∫—Ç–æ–≤ –Ω–µ—Ç –Ω–∞ —ç—Ç–æ–º —Å–µ—Ä–≤–µ—Ä–µ. –ú–µ–Ω—è—é —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ 5 —Å–µ–∫...")
            FruitTimerLabel.Text = "üåê –ú–µ–Ω—è—é —Å–µ—Ä–≤–µ—Ä (–Ω–µ—Ç —Ñ—Ä—É–∫—Ç–æ–≤)..."
            task.wait(5)
            ServerHop()
        else
            print("‚úÖ –§—Ä—É–∫—Ç—ã –Ω–∞–π–¥–µ–Ω—ã –Ω–∞ —ç—Ç–æ–º —Å–µ—Ä–≤–µ—Ä–µ: " .. #fruits)
        end
    end)
end

-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤
task.spawn(function()
    task.wait(10) -- –ñ–¥–µ–º 10 —Å–µ–∫ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
    
    while task.wait(60) do -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
        if _G.ServerHop then
            CheckForFruitsAndHop()
        end
    end
end)

-- // –õ–û–ì–ò–ö–ê –°–ö–†–ò–ü–¢–ê //

-- –ö–≤–µ—Å—Ç—ã
local QuestList = {
    {Req=0, Name="BanditQuest1", Id=1, Mob="Bandit"},
    {Req=10, Name="JungleQuest", Id=1, Mob="Monkey"},
    {Req=15, Name="JungleQuest", Id=2, Mob="Gorilla"},
    {Req=20, Name="JungleQuest", Id=3, Mob="Gorilla King"},
    {Req=30, Name="BuggyQuest1", Id=1, Mob="Pirate"},
    {Req=40, Name="BuggyQuest1", Id=2, Mob="Brute"},
    {Req=60, Name="DesertQuest", Id=1, Mob="Desert Bandit"},
    {Req=75, Name="DesertQuest", Id=2, Mob="Desert Officer"},
    {Req=90, Name="SnowQuest", Id=1, Mob="Snow Bandit"},
    {Req=100, Name="SnowQuest", Id=2, Mob="Snowman"},
    {Req=120, Name="MarineQuest2", Id=1, Mob="Chief Petty Officer"},
    {Req=150, Name="SkyQuest", Id=1, Mob="Sky Bandit"},
    {Req=175, Name="SkyQuest", Id=2, Mob="Dark Master"},
    {Req=190, Name="PrisonerQuest", Id=1, Mob="Prisoner"},
    {Req=210, Name="PrisonerQuest", Id=2, Mob="Dangerous Prisoner"},
    {Req=225, Name="ColosseumQuest", Id=1, Mob="Toga Warrior"},
    {Req=275, Name="ColosseumQuest", Id=2, Mob="Gladiator"},
    {Req=300, Name="MagmaQuest", Id=1, Mob="Military Soldier"},
    {Req=325, Name="MagmaQuest", Id=2, Mob="Military Spy"},
    {Req=375, Name="FishmanQuest", Id=1, Mob="Fishman Warrior"},
    {Req=400, Name="FishmanQuest", Id=2, Mob="Fishman Commando"},
    {Req=450, Name="SkyExp1Quest", Id=1, Mob="God's Guard"},
    {Req=475, Name="SkyExp1Quest", Id=2, Mob="Shanda"},
    {Req=525, Name="SkyExp2Quest", Id=1, Mob="Royal Squad"},
    {Req=625, Name="FountainQuest", Id=1, Mob="Galley Pirate"},
    {Req=650, Name="FountainQuest", Id=2, Mob="Galley Captain"}
}

local function GetCurrentQuestConfig(level)
    for i = #QuestList, 1, -1 do
        if level >= QuestList[i].Req then
            if QuestList[i].Mob == "Gorilla King" then
                if not Workspace.Enemies:FindFirstChild("Gorilla King") then
                    continue
                end
            end
            return QuestList[i]
        end
    end
    return QuestList[1]
end

local function GetQuestTarget()
    local gui = Player:FindFirstChild("PlayerGui")
    if gui and gui:FindFirstChild("Main") and gui.Main:FindFirstChild("Quest") then
        local q = gui.Main.Quest
        if q.Visible then
            local t = q.Container.QuestTitle.Title.Text
            for _, cfg in pairs(QuestList) do
                if string.find(t, cfg.Mob) then return cfg.Mob end
            end
        end
    end
    return nil
end

local function EquipBest()
    local char = Player.Character
    if not char then return end
    local tool = char:FindFirstChildOfClass("Tool")
    if tool then return tool end
    for _, t in pairs(Player.Backpack:GetChildren()) do
        if t:IsA("Tool") and (t.ToolTip == "Melee" or t.Name == "Combat" or t.ToolTip == "Sword") then
            char.Humanoid:EquipTool(t)
            return t
        end
    end
end

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ - —Å–µ—Ä–≤–µ—Ä–Ω—ã–π —Ñ—Ä—É–∫—Ç –∏–ª–∏ –æ—Ç –∏–≥—Ä–æ–∫–∞
local function IsServerFruit(fruitPosition)
    local minDistance = math.huge
    
    for _, spawnPoint in pairs(FruitSpawnLocations) do
        local distance = (fruitPosition - spawnPoint).Magnitude
        if distance < minDistance then
            minDistance = distance
        end
    end
    
    -- –ï—Å–ª–∏ —Ñ—Ä—É–∫—Ç –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 100 —Å—Ç–∞–¥–æ–≤ –æ—Ç –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ —Å–ø–∞–≤–Ω-–ø–æ–∏–Ω—Ç–∞ = —Å–µ—Ä–≤–µ—Ä–Ω—ã–π
    -- –ò–Ω–∞—á–µ = –∏–≥—Ä–æ–∫ –≤—ã–±—Ä–æ—Å–∏–ª
    if minDistance < 100 then
        return true
    end
    
    -- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —Ñ—Ä—É–∫—Ç —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø–æ—è–≤–∏–ª—Å—è –∏ –µ–≥–æ –Ω–µ –±—ã–ª–æ —Ä–∞–Ω—å—à–µ
    -- –¢–æ –∑–∞–ø–æ–º–∏–Ω–∞–µ–º —ç—Ç–æ –º–µ—Å—Ç–æ –∫–∞–∫ –Ω–æ–≤—ã–π —Å–ø–∞–≤–Ω-–ø–æ–∏–Ω—Ç
    return false
end

-- –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ —Ñ—Ä—É–∫—Ç–æ–≤ (–¢–û–õ–¨–ö–û –°–ï–†–í–ï–†–ù–´–ï)
local function FindAllFruits()
    local fruits = {}
    for _, v in pairs(Workspace:GetChildren()) do
        if string.find(v.Name, "Fruit") and v:IsA("Tool") and v:FindFirstChild("Handle") then
            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º - —Å–µ—Ä–≤–µ—Ä–Ω—ã–π —Ñ—Ä—É–∫—Ç –∏–ª–∏ –Ω–µ—Ç
            if IsServerFruit(v.Handle.Position) then
                table.insert(fruits, v)
                
                -- –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–ø–∞–≤–Ω-–ø–æ–∏–Ω—Ç–æ–≤ –µ—Å–ª–∏ –Ω–æ–≤—ã–π
                local isKnown = false
                for _, known in pairs(FruitSpawnLocations) do
                    if (v.Handle.Position - known).Magnitude < 50 then
                        isKnown = true
                        break
                    end
                end
                
                if not isKnown then
                    table.insert(FruitSpawnLocations, v.Handle.Position)
                    print("üÜï –ù–∞–π–¥–µ–Ω –Ω–æ–≤—ã–π —Å–ø–∞–≤–Ω-–ø–æ–∏–Ω—Ç —Ñ—Ä—É–∫—Ç–∞: " .. v.Name)
                end
            end
        end
    end
    return fruits
end

-- –°–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–ø–∞–≤–Ω–∞
local function UpdateFruitTracking()
    local currentFruits = FindAllFruits()
    local currentFruitNames = {}
    
    for _, fruit in pairs(currentFruits) do
        currentFruitNames[fruit.Name] = true
    end
    
    for fruitName, _ in pairs(currentFruitNames) do
        if not FruitSpawnData.LastSeenFruits[fruitName] then
            local spawnTime = os.time()
            
            if FruitSpawnData.LastDespawnTime > 0 then
                local interval = spawnTime - FruitSpawnData.LastDespawnTime
                table.insert(FruitSpawnData.SpawnTimes, interval)
                
                if #FruitSpawnData.SpawnTimes > 5 then
                    table.remove(FruitSpawnData.SpawnTimes, 1)
                end
                
                local sum = 0
                for _, time in pairs(FruitSpawnData.SpawnTimes) do
                    sum = sum + time
                end
                FruitSpawnData.AverageSpawnTime = math.floor(sum / #FruitSpawnData.SpawnTimes)
            end
            
            FruitSpawnData.LastSeenFruits[fruitName] = spawnTime
        end
    end
    
    for fruitName, _ in pairs(FruitSpawnData.LastSeenFruits) do
        if not currentFruitNames[fruitName] then
            FruitSpawnData.LastSeenFruits[fruitName] = nil
            FruitSpawnData.LastDespawnTime = os.time()
        end
    end
    
    return currentFruits
end

-- –ê–≤—Ç–æ—Å–±–æ—Ä —Ñ—Ä—É–∫—Ç–æ–≤ (–ë–ï–°–ö–û–ù–ï–ß–ù–´–ô –†–ê–î–ò–£–°)
task.spawn(function()
    while task.wait(3) do
        if _G.AutoCollectFruit and Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
            pcall(function()
                local fruits = FindAllFruits()
                
                if #fruits > 0 then
                    -- –ò—â–µ–º –±–ª–∏–∂–∞–π—à–∏–π —Ñ—Ä—É–∫—Ç (–∏–∑ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö)
                    local nearestFruit = nil
                    local nearestDist = math.huge
                    
                    for _, fruit in pairs(fruits) do
                        local dist = (Player.Character.HumanoidRootPart.Position - fruit.Handle.Position).Magnitude
                        if dist < nearestDist then
                            nearestDist = dist
                            nearestFruit = fruit
                        end
                    end
                    
                    if nearestFruit then
                        print("üçé –¢–µ–ª–µ–ø–æ—Ä—Ç –∫ —Ñ—Ä—É–∫—Ç—É: " .. nearestFruit.Name .. " (" .. math.floor(nearestDist) .. "m)")
                        
                        -- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                        for i = 1, 3 do
                            Player.Character.HumanoidRootPart.CFrame = nearestFruit.Handle.CFrame * CFrame.new(0, 5, 0)
                            task.wait(0.2)
                            Player.Character.HumanoidRootPart.CFrame = nearestFruit.Handle.CFrame
                            task.wait(0.3)
                            
                            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º - –ø–æ–¥–æ–±—Ä–∞–ª–∏ –ª–∏ —Ñ—Ä—É–∫—Ç
                            if not nearestFruit.Parent then
                                print("‚úÖ –§—Ä—É–∫—Ç –ø–æ–¥–æ–±—Ä–∞–Ω!")
                                break
                            end
                        end
                    end
                end
            end)
        end
    end
end)

-- Bring Mobs (–§–ò–ù–ê–õ–¨–ù–ê–Ø –í–ï–†–°–ò–Ø - –º–æ–±—ã –≤ –æ–¥–Ω–æ–π —Ç–æ—á–∫–µ —Ä—è–¥–æ–º —Å —Ç–æ–±–æ–π)
local MobBringIndex = 0
local function BringMobs(targetPos)
    if not _G.BringMobs then return end
    
    pcall(function()
        local enemies = Workspace:FindFirstChild("Enemies")
        if not enemies then return end
        
        local targetName = GetQuestTarget()
        local mobCount = 0
        
        for _, v in pairs(enemies:GetChildren()) do
            if v:FindFirstChild("Humanoid") and v:FindFirstChild("HumanoidRootPart") and v.Humanoid.Health > 0 then
                if not targetName or string.find(v.Name, targetName) then
                    local mobRoot = v.HumanoidRootPart
                    
                    -- –ü—Ä–æ–≤–µ—Ä–∫–∞: –Ω–µ —Å–ª–∏—à–∫–æ–º –ª–∏ –¥–∞–ª–µ–∫–æ –æ—Ç —Å–ø–∞–≤–Ω–∞ (–∑–∞—â–∏—Ç–∞ –æ—Ç Leash)
                    local distanceFromTarget = (mobRoot.Position - targetPos.Position).Magnitude
                    if distanceFromTarget > 200 then
                        continue
                    end
                    
                    -- –¢–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–±–∞ –í –û–î–ù–£ –¢–û–ß–ö–£ (–ø—Ä—è–º–æ –∫ —Ç–µ–±–µ)
                    mobRoot.CFrame = targetPos
                    mobRoot.Velocity = Vector3.zero
                    mobRoot.CanCollide = false
                    
                    -- –ó–ê–ú–û–†–ê–ñ–ò–í–ê–ï–ú –º–æ–±–∞
                    if v.Humanoid then
                        v.Humanoid.WalkSpeed = 0
                        v.Humanoid.JumpPower = 0
                        v.Humanoid.PlatformStand = true
                    end
                    
                    -- –û—Ç–∫–ª—é—á–∞–µ–º CanCollide —É –í–°–ï–• —á–∞—Å—Ç–µ–π –º–æ–±–∞
                    for _, part in pairs(v:GetDescendants()) do
                        if part:IsA("BasePart") then
                            part.CanCollide = false
                        end
                    end
                    
                    mobCount = mobCount + 1
                end
            end
        end
        
        -- –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ-–ø–∞–Ω–µ–ª—å
        if mobCount > 0 then
            InfoLabel.Text = "‚ö° –ú–æ–±–æ–≤ —Å–æ–±—Ä–∞–Ω–æ: " .. mobCount .. " | Fast Attack –∞–∫—Ç–∏–≤–µ–Ω"
        end
    end)
end

-- –ê–≤—Ç–æ—Ñ–∞—Ä–º (–£–õ–£–ß–®–ï–ù–ù–´–ô –° –ó–ê–©–ò–¢–û–ô)
task.spawn(function()
    while task.wait() do
        if _G.AutoFarm and Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
            pcall(function()
                -- 1. –ö–≤–µ—Å—Ç
                if _G.AutoQuest then
                    local gui = Player.PlayerGui
                    if gui.Main.Quest.Visible == false then
                        local lvl = Player.Data.Level.Value
                        local questConfig = GetCurrentQuestConfig(lvl)
                        if questConfig then
                            ReplicatedStorage.Remotes.CommF_:InvokeServer("StartQuest", questConfig.Name, questConfig.Id)
                        end
                    end
                end

                -- 2. –¶–µ–ª—å
                local targetName = GetQuestTarget()
                local target = nil
                local enemies = Workspace:FindFirstChild("Enemies")
                if enemies then
                    for _, v in pairs(enemies:GetChildren()) do
                        if v:FindFirstChild("Humanoid") and v.Humanoid.Health > 0 and v:FindFirstChild("HumanoidRootPart") then
                            if not targetName or string.find(v.Name, targetName) then
                                target = v
                                break
                            end
                        end
                    end
                end

                -- 3. –ê—Ç–∞–∫–∞
                if target then
                    local weapon = EquipBest()
                    
                    -- –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –ü–û–ó–ò–¶–ò–Ø: –ù–ò–ó–ö–û –Ω–∞–¥ –º–æ–±–æ–º (5 —Å—Ç—É–¥–æ–≤)
                    local safePos = target.HumanoidRootPart.Position + Vector3.new(0, _G.FarmHeight, 0)
                    
                    -- –°—Ç–æ–∏–º –ù–ê –ú–ï–°–¢–ï, —Å–º–æ—Ç—Ä–∏–º –Ω–∞ –º–æ–±–∞
                    Player.Character.HumanoidRootPart.CFrame = CFrame.new(safePos, target.HumanoidRootPart.Position)
                    Player.Character.HumanoidRootPart.Velocity = Vector3.zero
                    
                    -- –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ—Ö –º–æ–±–æ–≤ –ü–†–Ø–ú–û –ö –°–ï–ë–ï (–≤ –æ–¥–Ω—É —Ç–æ—á–∫—É)
                    BringMobs(CFrame.new(safePos))
                    
                    if weapon then 
                        -- Fast Attack (–£–õ–£–ß–®–ï–ù–ù–´–ô - —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –∞–Ω—Ç–∏—á–∏—Ç–∞)
                        if _G.FastAttack then
                            local currentTime = tick()
                            -- –ó–∞–¥–µ—Ä–∂–∫–∞ 0.1 —Å–µ–∫ - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã—Å—Ç—Ä–æ, –Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ
                            if currentTime - AttackCooldown >= 0.1 then
                                weapon:Activate()
                                AttackCooldown = currentTime
                                
                                if _G.MobileAttackOnly then
                                    local cam = Workspace.CurrentCamera
                                    local cx = math.floor(cam.ViewportSize.X/2)
                                    local cy = math.floor(cam.ViewportSize.Y/2)
                                    
                                    -- –£–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–∫–æ–≤ –¥–æ 2 (–±—ã–ª–æ 3)
                                    for i = 1, 2 do
                                        task.spawn(function()
                                            pcall(function()
                                                VirtualInputManager:SendMouseButtonEvent(cx, cy, 0, true, game, 1)
                                                task.wait(0.02) -- –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∫–ª–∏–∫–∞–º–∏
                                                VirtualInputManager:SendMouseButtonEvent(cx, cy, 0, false, game, 1)
                                            end)
                                        end)
                                    end
                                end
                            end
                        else
                            weapon:Activate()
                        end
                    end
                end
            end)
        end
    end
end)

-- ESP —Ü–∏–∫–ª
task.spawn(function()
    while task.wait(1) do
        pcall(function()
            local currentFruits = UpdateFruitTracking()
            
            if _G.FruitESP then
                for _, fruit in pairs(currentFruits) do
                    if not fruit.Handle:FindFirstChild("FruitESP") then
                        local b = Instance.new("BillboardGui")
                        b.Name = "FruitESP"
                        b.Adornee = fruit.Handle
                        b.Size = UDim2.new(0, 200, 0, 50)
                        b.StudsOffset = Vector3.new(0, 2, 0)
                        b.AlwaysOnTop = true
                        
                        local t = Instance.new("TextLabel")
                        t.Parent = b
                        t.Size = UDim2.new(1,0,1,0)
                        t.BackgroundTransparency = 1
                        t.TextColor3 = Color3.fromRGB(255, 215, 0) -- –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö
                        t.TextStrokeTransparency = 0
                        t.Font = Enum.Font.SourceSansBold
                        t.TextSize = 14
                        t.Text = fruit.Name
                        b.Parent = fruit.Handle
                    end
                    
                    if fruit.Handle:FindFirstChild("FruitESP") and Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
                        local dist = math.floor((Player.Character.HumanoidRootPart.Position - fruit.Handle.Position).Magnitude)
                        fruit.Handle.FruitESP.TextLabel.Text = "üåü " .. fruit.Name .. " [" .. dist .. "m]"
                    end
                end
            else
                for _, fruit in pairs(currentFruits) do
                    if fruit.Handle:FindFirstChild("FruitESP") then
                        fruit.Handle.FruitESP:Destroy()
                    end
                end
            end
            
            -- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞
            if #currentFruits > 0 then
                FruitTimerLabel.Text = "üçé –°–µ—Ä–≤–µ—Ä–Ω—ã—Ö —Ñ—Ä—É–∫—Ç–æ–≤: " .. #currentFruits .. " | –°–ª–µ–¥. ~" .. math.floor(FruitSpawnData.AverageSpawnTime/60) .. "–º"
            else
                if FruitSpawnData.LastDespawnTime > 0 then
                    local elapsed = os.time() - FruitSpawnData.LastDespawnTime
                    local remaining = math.max(0, FruitSpawnData.AverageSpawnTime - elapsed)
                    local m = math.floor(remaining/60)
                    local s = remaining % 60
                    FruitTimerLabel.Text = string.format("‚è∞ –°–ª–µ–¥. —Å–µ—Ä–≤–µ—Ä–Ω—ã–π —Ñ—Ä—É–∫—Ç: ~%02d:%02d", m, s)
                else
                    FruitTimerLabel.Text = "‚è∞ –û–∂–∏–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ —Ñ—Ä—É–∫—Ç–∞..."
                end
            end
        end)
    end
end)

-- Noclip
RunService.Stepped:Connect(function()
    if _G.AutoFarm and Player.Character then
        for _, v in pairs(Player.Character:GetDescendants()) do
            if v:IsA("BasePart") then 
                v.CanCollide = false 
            end
        end
    end
end)

-- Hitbox Expander (–û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–´–ô - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–∞–∑–º–µ—Ä)
task.spawn(function()
    while task.wait(0.2) do
        if _G.ReachAura then
            pcall(function()
                local enemies = Workspace:FindFirstChild("Enemies")
                if not enemies then return end
                
                local playerPos = Player.Character and Player.Character:FindFirstChild("HumanoidRootPart")
                if not playerPos then return end
                
                for _, v in pairs(enemies:GetChildren()) do
                    if v:FindFirstChild("Humanoid") and v:FindFirstChild("HumanoidRootPart") and v.Humanoid.Health > 0 then
                        local mobRoot = v.HumanoidRootPart
                        
                        -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ (Magnitude Check –∑–∞—â–∏—Ç–∞)
                        -- –ù–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ö–∏—Ç–±–æ–∫—Å, –µ—Å–ª–∏ –º–æ–± –¥–∞–ª—å—à–µ 60 —Å—Ç—É–¥–æ–≤
                        local distance = (playerPos.Position - mobRoot.Position).Magnitude
                        if distance > 60 then
                            continue
                        end
                        
                        -- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ö–∏—Ç–±–æ–∫—Å–∞ (20x20x20)
                        mobRoot.Size = Vector3.new(_G.HitboxSize, _G.HitboxSize, _G.HitboxSize)
                        mobRoot.Transparency = 0.95
                        mobRoot.CanCollide = false
                        mobRoot.Massless = true
                        
                        -- –û—Ç–∫–ª—é—á–∞–µ–º –≤—Å–µ –∫–æ–ª–ª–∏–∑–∏–∏ —É –≤—Å–µ—Ö —á–∞—Å—Ç–µ–π
                        for _, part in pairs(v:GetDescendants()) do
                            if part:IsA("BasePart") then
                                part.CanCollide = false
                            end
                        end
                    end
                end
            end)
        end
    end
end)

-- –ê–≤—Ç–æ-—Å—Ç–∞—Ç—ã
task.spawn(function()
    while task.wait(0.5) do
        if _G.AutoStats then
            pcall(function()
                local currentTime = tick()
                if currentTime - LastStatUpgrade >= 0.1 then
                    local points = Player.Data.Points.Value
                    if points > 0 then
                        local args = {
                            [1] = "AddPoint",
                            [2] = _G.StatToUpgrade,
                            [3] = 3
                        }
                        ReplicatedStorage.Remotes.CommF_:InvokeServer(unpack(args))
                        LastStatUpgrade = currentTime
                    end
                end
            end)
        end
    end
end)

-- –ê–Ω—Ç–∏-–∫–∏–∫
pcall(function()
    local mt = getrawmetatable(game)
    local oldNamecall = mt.__namecall
    setreadonly(mt, false)
    mt.__namecall = newcclosure(function(...)
        local method = getnamecallmethod()
        if method == "Kick" then
            return wait(9e9)
        end
        return oldNamecall(...)
    end)
    setreadonly(mt, true)
    print("‚úÖ –ê–Ω—Ç–∏-–∫–∏–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω")
end)

-- –ê–Ω—Ç–∏-AFK
Player.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
end)

-- –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–∞–¥–µ–Ω–∏—è
task.spawn(function()
    while task.wait(0.5) do
        if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
            if Player.Character.HumanoidRootPart.Position.Y < -500 then
                Player.Character.HumanoidRootPart.CFrame = CFrame.new(
                    Player.Character.HumanoidRootPart.Position.X,
                    100,
                    Player.Character.HumanoidRootPart.Position.Z
                )
            end
        end
    end
end)

print("‚úÖ Blox Fruits Script v5 MEGA –∑–∞–≥—Ä—É–∂–µ–Ω!")
print("üì± –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É MENU")
print("üçé –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¢–û–õ–¨–ö–û —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö —Ñ—Ä—É–∫—Ç–æ–≤")
print("‚ö° Fast Attack + Bring Mobs + –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ —Ö–∏—Ç–±–æ–∫—Å—ã")
print("üõ°Ô∏è –§–∞—Ä–º —Å –≤—ã—Å–æ—Ç—ã " .. _G.FarmHeight .. " —Å—Ç–∞–¥–æ–≤ –¥–ª—è –∑–∞—â–∏—Ç—ã")
print("üåê Server Hop: –ê–≤—Ç–æ–ø–æ–∏—Å–∫ —Ñ—Ä—É–∫—Ç–æ–≤ –Ω–∞ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö")
print("‚è∞ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤ –∫–∞–∂–¥—ã–µ " .. math.floor(_G.ServerHopDelay/60) .. " –º–∏–Ω—É—Ç")
